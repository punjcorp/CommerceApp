<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<title th:text="#{commerce.screen.customer.edit}"></title>
<!-- This thymeleaf fragment include all the header stuff -->
<div th:replace="common/header:: header"></div>
<script src="../../js/customer/customer_classes.js" th:src="@{/js/customer/customer_classes.js}"></script>
<script src="../../js/customer/customer.js" th:src="@{/js/customer/customer.js}"></script>
</head>
<body>
	<div id="wrapper">


		<!-- Page Content -->
		<div id="page-content-wrapper-no-menu">
			<!-- This thymeleaf fragment include the top navigation bar-->
			<div th:include="common/navbar :: navbarMenu"></div>
			<!-- This thymeleaf fragment is the body part for the page-->
			<div class="container">
				<div class="card">
					<div class="card-header">
						<h3 th:text="#{commerce.screen.customer.edit}">Edit a Customer</h3>
					</div>
					<div class="card-body">
						<div class="card-text">
							<div th:if="${ success!=null}" th:text="${success}" class="alert alert-success " role="alert"></div>
							<div th:if="${ alert!=null}" th:text="${alert}" class="alert alert-danger " role="alert"></div>
							<div id="customerActions" class="col-12 p-4" th:if="${ success!=null}">
								<a th:href="@{/admin/edit_customer(customerId=${customerBean.customerId})}" class="btn btn-sm btn-info"> <span class="fa-2x mx-2 fa-layers fa-fw">
										<i class="fas fa-male"></i> <i class="fas fa-pencil-alt" data-fa-transform="shrink-10 right-11 up-4"></i>
								</span> <span th:text="#{commerce.screen.actions.edit}"></span></a> <a th:href="@{/admin/add_customer}" class="btn btn-sm btn-success"> <span
									class="fa-2x mx-2 fa-layers fa-fw"> <i class="fas fa-male"></i> <i class="fas fa-plus" data-fa-transform="shrink-10 right-11 up-4"></i>
								</span> <span th:text="#{commerce.home.menu.add.customer}"></span></a> <a th:href="@{/admin/manage_customer}" class="btn btn-sm btn-success"><span
									class="fa-2x mx-2 fa-layers fa-fw"> <i class="fas fa-male"></i> <i class="fas fa-cog" data-fa-transform="shrink-10 right-11 up-4"></i>
								</span><span th:text="#{commerce.home.menu.manage.customer}"></span></a>
							</div>
							<form class="form" id="addForm" action="#" th:action="@{/admin/edit_customer}" th:object="${customerBean}" method="post">
								<div class="row">
									<div class="col-xs-3 col-sm-3 col-md-3">
										<div class="form-group text-left">
											<label for="name"><small><span th:text="#{commerce.screen.customer.id}">Customer Id</span></small></label>
											<div class="input-group text-left">
												<input type="hidden" th:field="*{customerId}"></input> <input type="hidden" th:field="*{createdBy}"></input> <input type="hidden"
													th:field="*{createdDate}"></input>
												<h5>
													<span th:text="*{customerId}"></span>
												</h5>
											</div>
											<small th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="text-danger">Name Error</small>
										</div>
									</div>
									<div class="col-xs-9 col-sm-9 col-md-9">
										<div class="form-group text-left">
											<label for="name"><small><span class="pos-mandatory" th:text="#{commerce.screen.customer.name}">Customer Name</span></small></label>
											<div class="input-group text-left">
												<input type="text" th:field="*{name}" class="form-control input-sm " th:placeholder="#{commerce.screen.customer.name.placeholder}" maxlength="80"></input>
											</div>
											<small th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="text-danger">Name Error</small>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-xs-6 col-sm-6 col-md-6">
										<div class="form-group  text-left">
											<label for="phone"><small><span class="pos-mandatory" th:text="#{commerce.screen.customer.phone1}">Customer Phone 1</span></small></label>
											<div class="input-group text-left">
												<input type="number" th:field="*{phone}" class="form-control input-sm pos-mandatory" th:placeholder="#{commerce.screen.customer.phone1.placeholder}"
													maxlength="15"></input>
											</div>
											<small th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}" class="text-danger">Phone 1 Error</small>
										</div>
									</div>
									<div class="col-xs-6 col-sm-6 col-md-6">
										<div class="form-group  text-left">
											<label for="phone2"><small><span th:text="#{commerce.screen.customer.phone2}">Customer Phone 2</span></small></label>
											<div class="input-group text-left">
												<input type="number" th:field="*{phone2}" class="form-control input-sm" th:placeholder="#{commerce.screen.customer.phone2.placeholder}"
													maxlength="15"></input>
											</div>
											<small th:if="${#fields.hasErrors('phone2')}" th:errors="*{phone2}" class="text-danger">Phone 2 Error</small>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-xs-12 col-sm-12 col-md-12">
										<div class="form-group  text-left">
											<label for="email"><small><span class="pos-mandatory" th:text="#{commerce.screen.customer.email}">Customer Email</span></small></label>
											<div class="input-group text-left">
												<input type="email" th:field="*{email}" class="form-control input-sm" th:placeholder="#{commerce.screen.customer.email.placeholder}" maxlength="80"></input>
											</div>
											<small th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="text-danger">Email Error</small>
										</div>
									</div>

								</div>
								<div class="row">
									<div class="col-xs-6 col-sm-6 col-md-6">
										<div class="form-group  text-left">
											<label for="gstNo"><small><span th:text="#{commerce.screen.customer.gst}">GST No</span></small></label>
											<div class="input-group text-left">
												<input type="text" th:field="*{gstNo}" class="form-control input-sm" th:placeholder="#{commerce.screen.customer.gst.placeholder}"></input>
											</div>
											<small th:if="${#fields.hasErrors('gstNo')}" th:errors="*{gstNo}" class="text-danger">GST No Error</small>
										</div>
									</div>
									<div class="col-xs-6 col-sm-6 col-md-6">
										<div class="form-group  text-left">
											<label for="gstNo"><small><span th:text="#{commerce.screen.customer.pan}">PAN No</span></small></label>
											<div class="input-group text-left">
												<input type="text" th:field="*{panNo}" class="form-control input-sm" th:placeholder="#{commerce.screen.customer.pan.placeholder}"></input>
											</div>
											<small th:if="${#fields.hasErrors('panNo')}" th:errors="*{panNo}" class="text-danger">PAN No Error</small>
										</div>
									</div>
								</div>

								<div class="text-right">
									<div class="form-group">
										<button type="button" id="btnAddCustomerAddress"
											th:class="${customerBean.addresses==null or #lists.size(customerBean.addresses)==0 ?'btn btn-secondary':'btn btn-secondary d-none'}">
											<i class="fas fa-address-card fa-2x mx-2"></i><span th:text="#{commerce.screen.btn.address.add}"></span>
										</button>
									</div>
									<small th:if="${#fields.hasErrors('addresses')}" th:errors="${customerBean.addresses}" class="text-danger">Customer Addresses Error</small>
								</div>

								<div th:class="${customerBean.addresses==null or #lists.size(customerBean.addresses)==0?'address form-group d-none':'address form-group'}"
									id="addressesContainer">

									<th:block th:each="address,itrStat:${customerBean.addresses}">
										<div class="row">
											<div class="col-12" th:id="'addressContainer'+${itrStat.index}">
												<div class="form-group">
													<label for="address1"><small><span class="pos-mandatory" th:text="#{commerce.screen.address.line1}">Address Line 1</span></small></label>
													<div class="input-group text-left">
														<input type="hidden" th:field="${customerBean.addresses[__${itrStat.index}__].addressId}" class="form-control input-sm"></input> <input
															type="text" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}" th:field="${customerBean.addresses[__${itrStat.index}__].address1}"
															class="form-control input-sm" th:placeholder="#{commerce.screen.address.line1.placeholder}" maxlength="150"></input>
													</div>
													<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].address1')}"
														th:errors="${customerBean.addresses[__${itrStat.index}__].address1}" class="text-danger">Address Line 1 Error</small>
												</div>
												<div class="row">
													<div class="col-xs-6 col-sm-6 col-md-6">
														<div class="form-group">
															<label for="address2"><small><span th:text="#{commerce.screen.address.line2}">Address Line 2</span></small></label>
															<div class="input-group text-left">
																<input type="text" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}"
																	th:field="${customerBean.addresses[__${itrStat.index}__].address2}" class="form-control input-sm"
																	th:placeholder="#{commerce.screen.address.line2.placeholder}" maxlength="150"></input>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].address2')}"
																th:errors="${customerBean.addresses[__${itrStat.index}__].address2}" class="text-danger">Address Line 2 Error</small>
														</div>
													</div>
													<div class="col-xs-6 col-sm-6 col-md-6">
														<div class="form-group">
															<label for="landmark"><small><span th:text="#{commerce.screen.address.landmark}">Landmark</span></small></label>
															<div class="input-group text-left">
																<input type="text" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}"
																	th:field="${customerBean.addresses[__${itrStat.index}__].landmark}" class="form-control input-sm"
																	th:placeholder="#{commerce.screen.address.landmark.placeholder}" maxlength="150"></input>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].landmark')}"
																th:errors="${customerBean.addresses[__${itrStat.index}__].landmark}" class="text-danger">Address Landmark Error</small>
														</div>
													</div>
												</div>
												<div class="row">
													<div class="col-xs-4 col-sm-4 col-md-4">
														<div class="form-group">
															<label for="city"><small><span class="pos-mandatory" th:text="#{commerce.screen.address.city}">City</span></small></label>
															<div class="input-group text-left">
																<input type="text" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}" th:field="${customerBean.addresses[__${itrStat.index}__].city}"
																	class="form-control input-sm" th:placeholder="#{commerce.screen.address.city.placeholder}" maxlength="30"></input>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].city')}" th:errors="${customerBean.addresses[__${itrStat.index}__].city}"
																class="text-danger">City Error</small>
														</div>
													</div>
													<div class="col-xs-4 col-sm-4 col-md-4">
														<div class="form-group">
															<label for="district"><small><span th:text="#{commerce.screen.address.district}">District</span></small></label>
															<div class="input-group text-left">
																<input type="text" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}"
																	th:field="${customerBean.addresses[__${itrStat.index}__].district}" class="form-control input-sm"
																	th:placeholder="#{commerce.screen.address.district.placeholder}" maxlength="50"></input>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].district')}"
																th:errors="${customerBean.addresses[__${itrStat.index}__].district}" class="text-danger">District Error</small>
														</div>
													</div>
													<div class="col-xs-4 col-sm-4 col-md-4">

														<div class="form-group text-left">
															<label for="locationId"><small><span class="pos-mandatory" th:text="#{commerce.screen.address.state}">State </span></small></label>
															<div class="input-group">
																<select th:onChange="${'addressChanged(this,' + itrStat.index + ')'}" th:field="${customerBean.addresses[__${itrStat.index}__].state}"
																	class="form-control input-sm">
																	<option class="form-text text-muted" value="" selected="selected" th:text="#{commerce.screen.address.state.placeholder}">Select
															State</option>
																	<option th:each="state: ${states}" th:value="${state.stateShortName}" th:text="${state.stateCode} + ' - ' +${state.stateName}"></option>
																</select>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].state')}" th:errors="${customerBean.addresses[__${itrStat.index}__].state}"
																class="text-danger">State Error</small>
															<div id="locationMsg"></div>
														</div>



													</div>
												</div>
												<div class="row">
													<div class="col-xs-6 col-sm-6 col-md-6">
														<div class="form-group">
															<label for="country"><small><span class="pos-mandatory" th:text="#{commerce.screen.address.country}">Country</span></small></label>
															<div class="input-group text-left">
																<input type="text" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}"
																	th:field="${customerBean.addresses[__${itrStat.index}__].country}" class="form-control input-sm"
																	th:placeholder="#{commerce.screen.address.country.placeholder}" maxlength="45"></input>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].country')}"
																th:errors="${customerBean.addresses[__${itrStat.index}__].country}" class="text-danger">Country Error</small>
														</div>
													</div>
													<div class="col-xs-6 col-sm-6 col-md-6">
														<div class="form-group">
															<label for="pincode"><small><span class="pos-mandatory" th:text="#{commerce.screen.address.pincode}">Pincode</span></small></label>
															<div class="input-group text-left">
																<input type="number" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}"
																	th:field="${customerBean.addresses[__${itrStat.index}__].pincode}" class="form-control input-sm"
																	th:placeholder="#{commerce.screen.address.pincode.placeholder}" maxlength="6"></input>
															</div>
															<small th:if="${#fields.hasErrors('addresses[__${itrStat.index}__].pincode')}"
																th:errors="${customerBean.addresses[__${itrStat.index}__].pincode}" class="text-danger">Pincode Error</small>
														</div>
													</div>
												</div>
												<div class="row">
													<div class="col-xs-3 col-sm-3 col-md-3">
														<div class="form-group">
															<label for="primary"><small><span></span></small></label>
															<div class="input-group text-left">
																<div class="form-check text-center">
																	<input type="radio" th:onChange="${'addressChanged(this,' + itrStat.index + ')'}" th:field="${customerBean.primaryAddressIndex}"
																		th:value="${itrStat.index}" class="form-check-input"></input> <label class="form-check-label"><span
																		th:text="#{commerce.screen.address.primary}">Primary</span></label>
																</div>
															</div>
															<small th:if="${#fields.hasErrors('primaryAddressIndex')}" th:errors="${customerBean.primaryAddressIndex}" class="text-danger">Primary
																Error</small>
														</div>
													</div>
													<div class="col-xs-3 col-sm-3 col-md-3">
														<div class="form-group">
															<label for="addressType"><small><span class="pos-mandatory" th:text="#{commerce.screen.address.type}">Select Address Type</span></small></label>
															<div class="input-group text-left">
																<select th:onChange="${'addressChanged(this,' + itrStat.index + ')'}" th:field="${customerBean.addresses[__${itrStat.index}__].addressType}"
																	class="form-control input-sm" th:placeholder="#{commerce.screen.address.type}">
																	<option th:value="Work" th:text="#{commerce.screen.address.work}"></option>
																	<option th:value="Warehouse" th:text="#{commerce.screen.address.warehouse}"></option>
																	<option th:value="Home" th:text="#{commerce.screen.address.home}"></option>
																</select>
															</div>
														</div>
													</div>
													<div class="col-xs-6 col-sm-6 col-md-6" th:if="${itrStat.size > 0}">
														<div class="form-group">
															<label for="primary"><small><span></span></small></label>
															<div class="input-group text-left">
																<button type="button" th:onclick="'addAddress(this, '+${itrStat.index}+')'" class="btn btn-secondary mr-2">
																	<span class="fa-layers fa-fw fa-2x mr-3"> <i class="fas fa-address-card"></i> <i class="fas fa-plus"
																		data-fa-transform="shrink-10 right-14"></i>
																	</span><span th:text="#{commerce.screen.btn.address.add}"></span>
																</button>
																<button type="button" th:onclick="'deleteAddress(this, '+ ${itrStat.index} +')'" class="btn btn-secondary mr-2">
																	<span class="fa-layers fa-fw fa-2x mr-3"> <i class="fas fa-address-card"></i> <i class="fas fa-times"
																		data-fa-transform="shrink-10 right-14"></i>
																	</span><span th:text="#{commerce.screen.btn.address.delete}"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</th:block>
								</div>
								<div class="row">
									<div class="col-12" id="addressClone"></div>
								</div>
								<div class="row" th:if="${success==null}">
									<div class="col-xs-6 col-sm-6 col-md-6">
										<div class="form-group">
											<div class="input-group">
												<input type="submit" name="saveCustomer" value="Save" th:value="#{commerce.screen.btn.submit.save}" class="btn btn-info mr-3"></input> <a
													th:href="@{/admin/add_customer}" class="btn btn-sm btn-success mr-3"><span class="fa-2x mx-2 fa-layers fa-fw"> <i class="fas fa-male"></i>
														<i class="fas fa-plus" data-fa-transform="shrink-10 right-11 up-4"></i>
												</span><span th:text="#{commerce.screen.customer.btn.new.customer}"></span></a> <a th:href="@{/admin/manage_customer}" class="btn btn-sm btn-success mr-3">
													<span class="fa-2x mx-2 fa-layers fa-fw"> <i class="fas fa-male"></i> <i class="fas fa-cog" data-fa-transform="shrink-10 right-11 up-4"></i>
												</span> <span th:text="#{commerce.home.menu.manage.customer}"></span>
												</a>

											</div>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- /#page-content-wrapper -->
	</div>
	<!-- /#wrapper -->
	<script type="text/javascript" th:inline="javascript">
		/*<![CDATA[*/
		
		var gst_states = /*[[${states}]]*/;
		
		/*]]>*/
	</script>
	<script type="text/javascript" th:inline="javascript" th:if="${customerBean!=null and customerBean.addresses!=null}">
		/*<![CDATA[*/

		var customer_addresses = /*[[${customerBean.addresses}]]*/;	
		
		/*]]>*/
	</script>
</body>
</html>